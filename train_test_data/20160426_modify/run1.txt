/usr/bin/python2.7 /home/jdwang/PycharmProjects/digitRecognition/cnn/cnn_train.py
Using Theano backend.
==============================
使用CNN网络对图片进行分类
==============================
start running!
2016-07-12 01:08:55,649 : DEBUG : ==============================
2016-07-12 01:08:55,650 : DEBUG : 使用CNN网络对图片进行分类
2016-07-12 01:08:55,650 : DEBUG : ==============================
2016-07-12 01:08:55,650 : DEBUG : start running!
2016-07-12 01:08:55,650 : DEBUG : ====================
3400
39057
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
zeropadding2d_1 (ZeroPadding2D)  (None, 1, 17, 17)     0           zeropadding2d_input_1[0][0]
____________________________________________________________________________________________________
convolution2d_1 (Convolution2D)  (None, 32, 15, 15)    320         zeropadding2d_1[0][0]
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 32, 15, 15)    0           convolution2d_1[0][0]
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 32, 7, 7)      0           activation_1[0][0]
____________________________________________________________________________________________________
zeropadding2d_2 (ZeroPadding2D)  (None, 32, 9, 9)      0           maxpooling2d_1[0][0]
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 64, 7, 7)      18496       zeropadding2d_2[0][0]
____________________________________________________________________________________________________
activation_2 (Activation)        (None, 64, 7, 7)      0           convolution2d_2[0][0]
____________________________________________________________________________________________________
maxpooling2d_2 (MaxPooling2D)    (None, 64, 3, 3)      0           activation_2[0][0]
____________________________________________________________________________________________________
convolution2d_3 (Convolution2D)  (None, 128, 1, 1)     73856       maxpooling2d_2[0][0]
____________________________________________________________________________________________________
activation_3 (Activation)        (None, 128, 1, 1)     0           convolution2d_3[0][0]
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 128)           0           activation_3[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 100)           12900       flatten_1[0][0]
____________________________________________________________________________________________________
activation_4 (Activation)        (None, 100)           0           dense_1[0][0]
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 100)           0           activation_4[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 50)            5050        dropout_1[0][0]
____________________________________________________________________________________________________
activation_5 (Activation)        (None, 50)            0           dense_2[0][0]
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 50)            0           activation_5[0][0]
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 34)            1734        dropout_2[0][0]
____________________________________________________________________________________________________
activation_6 (Activation)        (None, 34)            0           dense_3[0][0]
====================================================================================================
Total params: 112356
____________________________________________________________________________________________________
None
2016-07-12 01:09:01,537 : DEBUG : {'nb_epoch': 80, 'num_labels': 34, 'verbose': 1}
{'nb_epoch': 80, 'num_labels': 34, 'verbose': 1}
Epoch 1/80
3400/3400 [==============================] - 13s - loss: 3.5237 - acc: 0.0374
Epoch 2/80
3400/3400 [==============================] - 13s - loss: 3.3727 - acc: 0.0800
Epoch 3/80
3400/3400 [==============================] - 13s - loss: 2.9933 - acc: 0.1309
Epoch 4/80
3400/3400 [==============================] - 13s - loss: 2.4994 - acc: 0.2344
Epoch 5/80
3400/3400 [==============================] - 13s - loss: 2.0543 - acc: 0.3235
Epoch 6/80
3400/3400 [==============================] - 13s - loss: 1.7009 - acc: 0.4379
Epoch 7/80
3400/3400 [==============================] - 13s - loss: 1.4054 - acc: 0.5285
Epoch 8/80
3400/3400 [==============================] - 13s - loss: 1.1787 - acc: 0.5897
Epoch 9/80
3400/3400 [==============================] - 13s - loss: 1.0435 - acc: 0.6512
Epoch 10/80
3400/3400 [==============================] - 13s - loss: 0.8808 - acc: 0.7132
Epoch 11/80
3400/3400 [==============================] - 13s - loss: 0.8059 - acc: 0.7297
Epoch 12/80
3400/3400 [==============================] - 13s - loss: 0.7353 - acc: 0.7526
Epoch 13/80
3400/3400 [==============================] - 13s - loss: 0.7065 - acc: 0.7662
Epoch 14/80
3400/3400 [==============================] - 13s - loss: 0.5863 - acc: 0.8121
Epoch 15/80
3400/3400 [==============================] - 13s - loss: 0.5481 - acc: 0.8182
Epoch 16/80
3400/3400 [==============================] - 13s - loss: 0.5125 - acc: 0.8265
Epoch 17/80
3400/3400 [==============================] - 13s - loss: 0.4782 - acc: 0.8371
Epoch 18/80
3400/3400 [==============================] - 13s - loss: 0.4852 - acc: 0.8482
Epoch 19/80
3400/3400 [==============================] - 13s - loss: 0.4740 - acc: 0.8438
Epoch 20/80
3400/3400 [==============================] - 13s - loss: 0.4540 - acc: 0.8494
Epoch 21/80
3400/3400 [==============================] - 13s - loss: 0.4453 - acc: 0.8582
Epoch 22/80
3400/3400 [==============================] - 13s - loss: 0.3704 - acc: 0.8794
Epoch 23/80
3400/3400 [==============================] - 13s - loss: 0.3910 - acc: 0.8774
Epoch 24/80
3400/3400 [==============================] - 13s - loss: 0.3846 - acc: 0.8785
Epoch 25/80
3400/3400 [==============================] - 13s - loss: 0.3312 - acc: 0.8962
Epoch 26/80
3400/3400 [==============================] - 13s - loss: 0.3336 - acc: 0.8879
Epoch 27/80
3400/3400 [==============================] - 13s - loss: 0.3373 - acc: 0.8924
Epoch 28/80
3400/3400 [==============================] - 13s - loss: 0.3492 - acc: 0.8850
Epoch 29/80
3400/3400 [==============================] - 13s - loss: 0.2942 - acc: 0.9018
Epoch 30/80
3400/3400 [==============================] - 13s - loss: 0.3062 - acc: 0.9047
Epoch 31/80
3400/3400 [==============================] - 13s - loss: 0.2698 - acc: 0.9153
Epoch 32/80
3400/3400 [==============================] - 13s - loss: 0.2821 - acc: 0.9174
Epoch 33/80
3400/3400 [==============================] - 13s - loss: 0.2514 - acc: 0.9218
Epoch 34/80
3400/3400 [==============================] - 13s - loss: 0.2626 - acc: 0.9179
Epoch 35/80
3400/3400 [==============================] - 13s - loss: 0.2633 - acc: 0.9138
Epoch 36/80
3400/3400 [==============================] - 13s - loss: 0.2497 - acc: 0.9265
Epoch 37/80
3400/3400 [==============================] - 13s - loss: 0.2524 - acc: 0.9215
Epoch 38/80
3400/3400 [==============================] - 13s - loss: 0.2428 - acc: 0.9256
Epoch 39/80
3400/3400 [==============================] - 13s - loss: 0.2252 - acc: 0.9282
Epoch 40/80
3400/3400 [==============================] - 13s - loss: 0.2441 - acc: 0.9226
Epoch 41/80
3400/3400 [==============================] - 13s - loss: 0.2381 - acc: 0.9209
Epoch 42/80
3400/3400 [==============================] - 13s - loss: 0.2445 - acc: 0.9224
Epoch 43/80
3400/3400 [==============================] - 13s - loss: 0.2120 - acc: 0.9315
Epoch 44/80
3400/3400 [==============================] - 13s - loss: 0.2097 - acc: 0.9306
Epoch 45/80
3400/3400 [==============================] - 13s - loss: 0.2080 - acc: 0.9362
Epoch 46/80
3400/3400 [==============================] - 13s - loss: 0.2006 - acc: 0.9350
Epoch 47/80
3400/3400 [==============================] - 13s - loss: 0.2307 - acc: 0.9247
Epoch 48/80
3400/3400 [==============================] - 13s - loss: 0.2203 - acc: 0.9279
Epoch 49/80
3400/3400 [==============================] - 13s - loss: 0.2180 - acc: 0.9326
Epoch 50/80
3400/3400 [==============================] - 13s - loss: 0.2192 - acc: 0.9315
Epoch 51/80
3400/3400 [==============================] - 13s - loss: 0.2125 - acc: 0.9332
Epoch 52/80
3400/3400 [==============================] - 13s - loss: 0.2111 - acc: 0.9362
Epoch 53/80
3400/3400 [==============================] - 13s - loss: 0.1958 - acc: 0.9424
Epoch 54/80
3400/3400 [==============================] - 13s - loss: 0.1978 - acc: 0.9382
Epoch 55/80
3400/3400 [==============================] - 13s - loss: 0.1890 - acc: 0.9441
Epoch 56/80
3400/3400 [==============================] - 13s - loss: 0.1927 - acc: 0.9374
Epoch 57/80
3400/3400 [==============================] - 13s - loss: 0.1863 - acc: 0.9421
Epoch 58/80
3400/3400 [==============================] - 13s - loss: 0.2082 - acc: 0.9288
Epoch 59/80
3400/3400 [==============================] - 13s - loss: 0.1713 - acc: 0.9485
Epoch 60/80
3400/3400 [==============================] - 13s - loss: 0.1900 - acc: 0.9400
Epoch 61/80
3400/3400 [==============================] - 13s - loss: 0.1710 - acc: 0.9456
Epoch 62/80
3400/3400 [==============================] - 13s - loss: 0.1789 - acc: 0.9447
Epoch 63/80
3400/3400 [==============================] - 13s - loss: 0.1700 - acc: 0.9479
Epoch 64/80
3400/3400 [==============================] - 13s - loss: 0.1666 - acc: 0.9518
Epoch 65/80
3400/3400 [==============================] - 13s - loss: 0.1786 - acc: 0.9394
Epoch 66/80
3400/3400 [==============================] - 13s - loss: 0.1716 - acc: 0.9459
Epoch 67/80
3400/3400 [==============================] - 13s - loss: 0.1664 - acc: 0.9532
Epoch 68/80
3400/3400 [==============================] - 13s - loss: 0.1639 - acc: 0.9503
Epoch 69/80
3400/3400 [==============================] - 13s - loss: 0.1718 - acc: 0.9471
Epoch 70/80
3400/3400 [==============================] - 13s - loss: 0.1655 - acc: 0.9468
Epoch 71/80
3400/3400 [==============================] - 13s - loss: 0.1575 - acc: 0.9485
Epoch 72/80
3400/3400 [==============================] - 13s - loss: 0.1592 - acc: 0.9503
Epoch 73/80
3400/3400 [==============================] - 13s - loss: 0.1739 - acc: 0.9485
Epoch 74/80
3400/3400 [==============================] - 13s - loss: 0.1672 - acc: 0.9435
Epoch 75/80
3400/3400 [==============================] - 13s - loss: 0.1709 - acc: 0.9412
Epoch 76/80
3400/3400 [==============================] - 13s - loss: 0.1661 - acc: 0.9424
Epoch 77/80
3400/3400 [==============================] - 13s - loss: 0.1642 - acc: 0.9482
Epoch 78/80
3400/3400 [==============================] - 13s - loss: 0.1627 - acc: 0.9474
Epoch 79/80
3400/3400 [==============================] - 13s - loss: 0.1628 - acc: 0.9524
Epoch 80/80
3400/3400 [==============================] - 13s - loss: 0.1420 - acc: 0.9568
train time : 1062.533138
39057/39057 [==============================] - 55s
[ True  True  True ...,  True  True  True]
2016-07-12 01:27:39,805 : DEBUG : 正确的个数:38780
正确的个数:38780
2016-07-12 01:27:39,935 : DEBUG : 准确率为:0.992908
准确率为:0.992908
2016-07-12 01:27:39,951 : DEBUG : F1为：[ 0.99663038  0.99074525  0.99448774  0.9996731   0.99933043  0.994003
  0.99917424  0.99293418  0.99210636  0.99950306  0.98529412  0.9
  0.99125364  0.96930946  1.          0.99570815  0.98689956  1.
  0.85057471  0.99215071  0.9991357   0.96590909  0.96888889  0.98165138
  0.99529412  0.97716895  0.99137931  0.85714286  0.86554622  0.98774259
  0.99645809  1.          0.99732262  0.93981481]
F1为：0.996630|0.990745|0.994488|0.999673|0.999330|0.994003|0.999174|0.992934|0.992106|0.999503|0.985294|0.900000|0.991254|0.969309|1.000000|0.995708|0.986900|1.000000|0.850575|0.992151|0.999136|0.965909|0.968889|0.981651|0.995294|0.977169|0.991379|0.857143|0.865546|0.987743|0.996458|1.000000|0.997323|0.939815
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
precision:[ 1.          0.99510763  1.          0.99956418  0.99933043  1.
  0.99933928  0.99589705  0.9997209   1.          0.99014778  0.82084691
  0.99125364  0.94278607  1.          1.          0.9826087   1.
  0.76027397  0.98442368  1.          0.93406593  0.97321429  0.96396396
  1.          0.95535714  0.98290598  0.75        0.78030303  0.99690722
  1.          1.          0.99732262  0.88646288]
precision为：1.000000|0.995108|1.000000|0.999564|0.999330|1.000000|0.999339|0.995897|0.999721|1.000000|0.990148|0.820847|0.991254|0.942786|1.000000|1.000000|0.982609|1.000000|0.760274|0.984424|1.000000|0.934066|0.973214|0.963964|1.000000|0.955357|0.982906|0.750000|0.780303|0.996907|1.000000|1.000000|0.997323|0.886463
2016-07-12 01:27:39,959 : DEBUG : precision:[ 1.          0.99510763  1.          0.99956418  0.99933043  1.
  0.99933928  0.99589705  0.9997209   1.          0.99014778  0.82084691
  0.99125364  0.94278607  1.          1.          0.9826087   1.
  0.76027397  0.98442368  1.          0.93406593  0.97321429  0.96396396
  1.          0.95535714  0.98290598  0.75        0.78030303  0.99690722
  1.          1.          0.99732262  0.88646288]
recall:[ 0.99328339  0.98642095  0.98903592  0.99978204  0.99933043  0.9880775
  0.99900925  0.98998888  0.98460693  0.99900662  0.9804878   0.99604743
  0.99125364  0.99736842  1.          0.99145299  0.99122807  1.
  0.96521739  1.          0.99827288  1.          0.96460177  1.
  0.99063232  1.          1.          1.          0.97169811  0.97874494
  0.99294118  1.          0.99732262  1.        ]
recall为：0.993283|0.986421|0.989036|0.999782|0.999330|0.988077|0.999009|0.989989|0.984607|0.999007|0.980488|0.996047|0.991254|0.997368|1.000000|0.991453|0.991228|1.000000|0.965217|1.000000|0.998273|1.000000|0.964602|1.000000|0.990632|1.000000|1.000000|1.000000|0.971698|0.978745|0.992941|1.000000|0.997323|1.000000
3400
39057
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
zeropadding2d_3 (ZeroPadding2D)  (None, 1, 17, 17)     0           zeropadding2d_input_2[0][0]
____________________________________________________________________________________________________
convolution2d_4 (Convolution2D)  (None, 32, 15, 15)    320         zeropadding2d_3[0][0]
____________________________________________________________________________________________________
activation_7 (Activation)        (None, 32, 15, 15)    0           convolution2d_4[0][0]
____________________________________________________________________________________________________
maxpooling2d_3 (MaxPooling2D)    (None, 32, 7, 7)      0           activation_7[0][0]
____________________________________________________________________________________________________
zeropadding2d_4 (ZeroPadding2D)  (None, 32, 9, 9)      0           maxpooling2d_3[0][0]
____________________________________________________________________________________________________
convolution2d_5 (Convolution2D)  (None, 64, 7, 7)      18496       zeropadding2d_4[0][0]
____________________________________________________________________________________________________
activation_8 (Activation)        (None, 64, 7, 7)      0           convolution2d_5[0][0]
____________________________________________________________________________________________________
maxpooling2d_4 (MaxPooling2D)    (None, 64, 3, 3)      0           activation_8[0][0]
____________________________________________________________________________________________________
convolution2d_6 (Convolution2D)  (None, 128, 1, 1)     73856       maxpooling2d_4[0][0]
____________________________________________________________________________________________________
activation_9 (Activation)        (None, 128, 1, 1)     0           convolution2d_6[0][0]
____________________________________________________________________________________________________
flatten_2 (Flatten)              (None, 128)           0           activation_9[0][0]
____________________________________________________________________________________________________
dense_4 (Dense)                  (None, 100)           12900       flatten_2[0][0]
____________________________________________________________________________________________________
activation_10 (Activation)       (None, 100)           0           dense_4[0][0]
____________________________________________________________________________________________________
dropout_3 (Dropout)              (None, 100)           0           activation_10[0][0]
____________________________________________________________________________________________________
dense_5 (Dense)                  (None, 50)            5050        dropout_3[0][0]
____________________________________________________________________________________________________
activation_11 (Activation)       (None, 50)            0           dense_5[0][0]
____________________________________________________________________________________________________
dropout_4 (Dropout)              (None, 50)            0           activation_11[0][0]
____________________________________________________________________________________________________
dense_6 (Dense)                  (None, 34)            1734        dropout_4[0][0]
____________________________________________________________________________________________________
activation_12 (Activation)       (None, 34)            0           dense_6[0][0]
====================================================================================================
Total params: 112356
____________________________________________________________________________________________________
None
2016-07-12 01:27:45,553 : DEBUG : {'nb_epoch': 80, 'num_labels': 34, 'verbose': 1}
{'nb_epoch': 80, 'num_labels': 34, 'verbose': 1}
Epoch 1/80
3400/3400 [==============================] - 13s - loss: 3.5273 - acc: 0.0388
Epoch 2/80
3400/3400 [==============================] - 13s - loss: 3.4005 - acc: 0.0632
Epoch 3/80
3400/3400 [==============================] - 13s - loss: 3.1235 - acc: 0.1365
Epoch 4/80
3400/3400 [==============================] - 13s - loss: 2.6738 - acc: 0.2238
Epoch 5/80
3400/3400 [==============================] - 13s - loss: 2.1149 - acc: 0.3456
Epoch 6/80
3400/3400 [==============================] - 13s - loss: 1.6878 - acc: 0.4582
Epoch 7/80
3400/3400 [==============================] - 13s - loss: 1.3509 - acc: 0.5585
Epoch 8/80
3400/3400 [==============================] - 13s - loss: 1.1096 - acc: 0.6329
Epoch 9/80
3400/3400 [==============================] - 13s - loss: 0.9141 - acc: 0.7047
Epoch 10/80
3400/3400 [==============================] - 13s - loss: 0.8042 - acc: 0.7338
Epoch 11/80
3400/3400 [==============================] - 13s - loss: 0.7157 - acc: 0.7626
Epoch 12/80
3400/3400 [==============================] - 13s - loss: 0.6425 - acc: 0.7824
Epoch 13/80
3400/3400 [==============================] - 13s - loss: 0.5631 - acc: 0.8047
Epoch 14/80
3400/3400 [==============================] - 13s - loss: 0.5521 - acc: 0.8197
Epoch 15/80
3400/3400 [==============================] - 13s - loss: 0.5173 - acc: 0.8397
Epoch 16/80
3400/3400 [==============================] - 13s - loss: 0.4667 - acc: 0.8403
Epoch 17/80
3400/3400 [==============================] - 13s - loss: 0.4358 - acc: 0.8653
Epoch 18/80
3400/3400 [==============================] - 13s - loss: 0.4591 - acc: 0.8503
Epoch 19/80
3400/3400 [==============================] - 13s - loss: 0.4157 - acc: 0.8709
Epoch 20/80
3400/3400 [==============================] - 13s - loss: 0.3875 - acc: 0.8788
Epoch 21/80
3400/3400 [==============================] - 13s - loss: 0.3624 - acc: 0.8891
Epoch 22/80
3400/3400 [==============================] - 13s - loss: 0.3546 - acc: 0.8888
Epoch 23/80
3400/3400 [==============================] - 13s - loss: 0.3376 - acc: 0.8915
Epoch 24/80
3400/3400 [==============================] - 13s - loss: 0.3256 - acc: 0.8968
Epoch 25/80
3400/3400 [==============================] - 13s - loss: 0.3077 - acc: 0.9024
Epoch 26/80
3400/3400 [==============================] - 13s - loss: 0.2727 - acc: 0.9121
Epoch 27/80
3400/3400 [==============================] - 13s - loss: 0.2930 - acc: 0.9076
Epoch 28/80
3400/3400 [==============================] - 13s - loss: 0.2761 - acc: 0.9162
Epoch 29/80
3400/3400 [==============================] - 13s - loss: 0.2484 - acc: 0.9206
Epoch 30/80
3400/3400 [==============================] - 13s - loss: 0.2850 - acc: 0.9071
Epoch 31/80
3400/3400 [==============================] - 13s - loss: 0.2682 - acc: 0.9135
Epoch 32/80
3400/3400 [==============================] - 13s - loss: 0.2617 - acc: 0.9188
Epoch 33/80
3400/3400 [==============================] - 13s - loss: 0.2864 - acc: 0.9182
Epoch 34/80
3400/3400 [==============================] - 13s - loss: 0.2605 - acc: 0.9179
Epoch 35/80
3400/3400 [==============================] - 13s - loss: 0.2403 - acc: 0.9203
Epoch 36/80
3400/3400 [==============================] - 13s - loss: 0.2412 - acc: 0.9241
Epoch 37/80
3400/3400 [==============================] - 13s - loss: 0.2248 - acc: 0.9324
Epoch 38/80
3400/3400 [==============================] - 13s - loss: 0.2395 - acc: 0.9294
Epoch 39/80
3400/3400 [==============================] - 13s - loss: 0.2121 - acc: 0.9347
Epoch 40/80
3400/3400 [==============================] - 13s - loss: 0.2406 - acc: 0.9224
Epoch 41/80
3400/3400 [==============================] - 13s - loss: 0.2351 - acc: 0.9300
Epoch 42/80
3400/3400 [==============================] - 13s - loss: 0.2157 - acc: 0.9309
Epoch 43/80
3400/3400 [==============================] - 13s - loss: 0.1947 - acc: 0.9444
Epoch 44/80
3400/3400 [==============================] - 13s - loss: 0.1776 - acc: 0.9426
Epoch 45/80
3400/3400 [==============================] - 13s - loss: 0.2098 - acc: 0.9379
Epoch 46/80
3400/3400 [==============================] - 13s - loss: 0.2091 - acc: 0.9335
Epoch 47/80
3400/3400 [==============================] - 13s - loss: 0.1941 - acc: 0.9424
Epoch 48/80
3400/3400 [==============================] - 13s - loss: 0.1537 - acc: 0.9471
Epoch 49/80
3400/3400 [==============================] - 13s - loss: 0.1812 - acc: 0.9435
Epoch 50/80
3400/3400 [==============================] - 13s - loss: 0.1769 - acc: 0.9426
Epoch 51/80
3400/3400 [==============================] - 13s - loss: 0.1710 - acc: 0.9450
Epoch 52/80
3400/3400 [==============================] - 13s - loss: 0.1873 - acc: 0.9412
Epoch 53/80
3400/3400 [==============================] - 13s - loss: 0.1718 - acc: 0.9482
Epoch 54/80
3400/3400 [==============================] - 13s - loss: 0.1973 - acc: 0.9415
Epoch 55/80
3400/3400 [==============================] - 13s - loss: 0.1801 - acc: 0.9471
Epoch 56/80
3400/3400 [==============================] - 13s - loss: 0.1691 - acc: 0.9485
Epoch 57/80
3400/3400 [==============================] - 13s - loss: 0.1968 - acc: 0.9365
Epoch 58/80
3400/3400 [==============================] - 13s - loss: 0.1629 - acc: 0.9500
Epoch 59/80
3400/3400 [==============================] - 13s - loss: 0.1649 - acc: 0.9488
Epoch 60/80
3400/3400 [==============================] - 13s - loss: 0.1614 - acc: 0.9497
Epoch 61/80
3400/3400 [==============================] - 13s - loss: 0.1572 - acc: 0.9509
Epoch 62/80
3400/3400 [==============================] - 13s - loss: 0.1598 - acc: 0.9476
Epoch 63/80
3400/3400 [==============================] - 13s - loss: 0.1716 - acc: 0.9465
Epoch 64/80
3400/3400 [==============================] - 13s - loss: 0.1698 - acc: 0.9506
Epoch 65/80
3400/3400 [==============================] - 13s - loss: 0.1648 - acc: 0.9485
Epoch 66/80
3400/3400 [==============================] - 13s - loss: 0.1759 - acc: 0.9429
Epoch 67/80
3400/3400 [==============================] - 13s - loss: 0.1494 - acc: 0.9494
Epoch 68/80
3400/3400 [==============================] - 13s - loss: 0.1461 - acc: 0.9562
Epoch 69/80
3400/3400 [==============================] - 13s - loss: 0.1531 - acc: 0.9488
Epoch 70/80
3400/3400 [==============================] - 13s - loss: 0.1570 - acc: 0.9497
Epoch 71/80
3400/3400 [==============================] - 13s - loss: 0.1534 - acc: 0.9556
Epoch 72/80
3400/3400 [==============================] - 13s - loss: 0.1590 - acc: 0.9468
Epoch 73/80
3400/3400 [==============================] - 13s - loss: 0.1379 - acc: 0.9541
Epoch 74/80
3400/3400 [==============================] - 13s - loss: 0.1521 - acc: 0.9497
Epoch 75/80
3400/3400 [==============================] - 13s - loss: 0.1602 - acc: 0.9503
Epoch 76/80
3400/3400 [==============================] - 13s - loss: 0.1585 - acc: 0.9535
Epoch 77/80
3400/3400 [==============================] - 13s - loss: 0.1471 - acc: 0.9512
Epoch 78/80
3400/3400 [==============================] - 13s - loss: 0.1299 - acc: 0.9562
Epoch 79/80
3400/3400 [==============================] - 13s - loss: 0.1438 - acc: 0.9544
Epoch 80/80
3400/3400 [==============================] - 13s - loss: 0.1344 - acc: 0.9559
train time : 1053.126800
39057/39057 [==============================] - 56s
[ True  True  True ...,  True  True  True]
2016-07-12 01:46:15,090 : DEBUG : 正确的个数:38650
正确的个数:38650
准确率为:0.989579
2016-07-12 01:46:15,224 : DEBUG : 准确率为:0.989579
F1为：0.996501|0.980817|0.993919|0.999891|0.999665|0.993626|0.999174|0.982133|0.991128|0.999503|0.983051|0.888889|0.991241|0.965517|1.000000|0.995745|0.995633|0.993197|0.833333|0.993691|0.998270|0.971429|0.968610|0.977169|0.930693|0.979405|0.991379|0.853211|0.700337|0.988271|0.996458|1.000000|0.997323|0.930556
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
2016-07-12 01:46:15,239 : DEBUG : F1为：[ 0.99650123  0.98081653  0.99391866  0.99989101  0.99966522  0.9936258
  0.99917396  0.98213278  0.99112836  0.99950306  0.98305085  0.88888889
  0.99124088  0.96551724  1.          0.99574468  0.99563319  0.99319728
  0.83333333  0.99369085  0.9982699   0.97142857  0.96860987  0.97716895
  0.93069307  0.97940503  0.99137931  0.85321101  0.7003367   0.98827129
  0.99645809  1.          0.99732262  0.93055556]
precision:[ 0.99973999  0.99500998  0.99923577  1.          0.99966522  1.
  0.99966942  0.99656489  0.99972036  1.          0.97596154  0.80254777
  0.99269006  0.93796526  1.          0.99152542  0.99130435  0.98648649
  0.73825503  0.99056604  1.          0.94444444  0.98181818  0.95535714
  0.87759336  0.95964126  0.98290598  0.744       0.54450262  0.995889    1.
  1.          0.99732262  0.87772926]
precision为：0.999740|0.995010|0.999236|1.000000|0.999665|1.000000|0.999669|0.996565|0.999720|1.000000|0.975962|0.802548|0.992690|0.937965|1.000000|0.991525|0.991304|0.986486|0.738255|0.990566|1.000000|0.944444|0.981818|0.955357|0.877593|0.959641|0.982906|0.744000|0.544503|0.995889|1.000000|1.000000|0.997323|0.877729
2016-07-12 01:46:15,247 : DEBUG : precision:[ 0.99973999  0.99500998  0.99923577  1.          0.99966522  1.
  0.99966942  0.99656489  0.99972036  1.          0.97596154  0.80254777
  0.99269006  0.93796526  1.          0.99152542  0.99130435  0.98648649
  0.73825503  0.99056604  1.          0.94444444  0.98181818  0.95535714
  0.87759336  0.95964126  0.98290598  0.744       0.54450262  0.995889    1.
  1.          0.99732262  0.87772926]
recall:[ 0.99328339  0.96702231  0.98865784  0.99978204  0.99966522  0.98733234
  0.998679    0.96811272  0.98268279  0.99900662  0.9902439   0.99604743
  0.98979592  0.99473684  1.          1.          1.          1.
  0.95652174  0.99683544  0.99654577  1.          0.95575221  1.
  0.99063232  1.          1.          1.          0.98113208  0.98076923
  0.99294118  1.          0.99732262  0.99014778]
recall为：0.993283|0.967022|0.988658|0.999782|0.999665|0.987332|0.998679|0.968113|0.982683|0.999007|0.990244|0.996047|0.989796|0.994737|1.000000|1.000000|1.000000|1.000000|0.956522|0.996835|0.996546|1.000000|0.955752|1.000000|0.990632|1.000000|1.000000|1.000000|0.981132|0.980769|0.992941|1.000000|0.997323|0.990148
3400
39059
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
zeropadding2d_5 (ZeroPadding2D)  (None, 1, 17, 17)     0           zeropadding2d_input_3[0][0]
____________________________________________________________________________________________________
convolution2d_7 (Convolution2D)  (None, 32, 15, 15)    320         zeropadding2d_5[0][0]
____________________________________________________________________________________________________
activation_13 (Activation)       (None, 32, 15, 15)    0           convolution2d_7[0][0]
____________________________________________________________________________________________________
maxpooling2d_5 (MaxPooling2D)    (None, 32, 7, 7)      0           activation_13[0][0]
____________________________________________________________________________________________________
zeropadding2d_6 (ZeroPadding2D)  (None, 32, 9, 9)      0           maxpooling2d_5[0][0]
____________________________________________________________________________________________________
convolution2d_8 (Convolution2D)  (None, 64, 7, 7)      18496       zeropadding2d_6[0][0]
____________________________________________________________________________________________________
activation_14 (Activation)       (None, 64, 7, 7)      0           convolution2d_8[0][0]
____________________________________________________________________________________________________
maxpooling2d_6 (MaxPooling2D)    (None, 64, 3, 3)      0           activation_14[0][0]
____________________________________________________________________________________________________
convolution2d_9 (Convolution2D)  (None, 128, 1, 1)     73856       maxpooling2d_6[0][0]
____________________________________________________________________________________________________
activation_15 (Activation)       (None, 128, 1, 1)     0           convolution2d_9[0][0]
____________________________________________________________________________________________________
flatten_3 (Flatten)              (None, 128)           0           activation_15[0][0]
____________________________________________________________________________________________________
dense_7 (Dense)                  (None, 100)           12900       flatten_3[0][0]
____________________________________________________________________________________________________
activation_16 (Activation)       (None, 100)           0           dense_7[0][0]
____________________________________________________________________________________________________
dropout_5 (Dropout)              (None, 100)           0           activation_16[0][0]
____________________________________________________________________________________________________
dense_8 (Dense)                  (None, 50)            5050        dropout_5[0][0]
____________________________________________________________________________________________________
activation_17 (Activation)       (None, 50)            0           dense_8[0][0]
____________________________________________________________________________________________________
dropout_6 (Dropout)              (None, 50)            0           activation_17[0][0]
____________________________________________________________________________________________________
dense_9 (Dense)                  (None, 34)            1734        dropout_6[0][0]
____________________________________________________________________________________________________
activation_18 (Activation)       (None, 34)            0           dense_9[0][0]
====================================================================================================
Total params: 112356
____________________________________________________________________________________________________
None
{'nb_epoch': 80, 'num_labels': 34, 'verbose': 1}
2016-07-12 01:46:20,734 : DEBUG : {'nb_epoch': 80, 'num_labels': 34, 'verbose': 1}
Epoch 1/80
3400/3400 [==============================] - 13s - loss: 3.5251 - acc: 0.0341
Epoch 2/80
3400/3400 [==============================] - 13s - loss: 3.3801 - acc: 0.0741
Epoch 3/80
3400/3400 [==============================] - 13s - loss: 2.9543 - acc: 0.1606
Epoch 4/80
3400/3400 [==============================] - 13s - loss: 2.3541 - acc: 0.2818
Epoch 5/80
3400/3400 [==============================] - 13s - loss: 1.8618 - acc: 0.4071
Epoch 6/80
3400/3400 [==============================] - 13s - loss: 1.4511 - acc: 0.5294
Epoch 7/80
3400/3400 [==============================] - 13s - loss: 1.2265 - acc: 0.5994
Epoch 8/80
3400/3400 [==============================] - 13s - loss: 1.0477 - acc: 0.6559
Epoch 9/80
3400/3400 [==============================] - 13s - loss: 0.9302 - acc: 0.6800
Epoch 10/80
3400/3400 [==============================] - 13s - loss: 0.8250 - acc: 0.7168
Epoch 11/80
3400/3400 [==============================] - 13s - loss: 0.7265 - acc: 0.7556
Epoch 12/80
3400/3400 [==============================] - 13s - loss: 0.6502 - acc: 0.7838
Epoch 13/80
3400/3400 [==============================] - 13s - loss: 0.6258 - acc: 0.7918
Epoch 14/80
3400/3400 [==============================] - 13s - loss: 0.5410 - acc: 0.8306
Epoch 15/80
3400/3400 [==============================] - 13s - loss: 0.5110 - acc: 0.8362
Epoch 16/80
3400/3400 [==============================] - 13s - loss: 0.4891 - acc: 0.8500
Epoch 17/80
3400/3400 [==============================] - 13s - loss: 0.4901 - acc: 0.8397
Epoch 18/80
3400/3400 [==============================] - 13s - loss: 0.4428 - acc: 0.8603
Epoch 19/80
3400/3400 [==============================] - 13s - loss: 0.4059 - acc: 0.8671
Epoch 20/80
3400/3400 [==============================] - 15s - loss: 0.3919 - acc: 0.8809
Epoch 21/80
3400/3400 [==============================] - 13s - loss: 0.3540 - acc: 0.8888
Epoch 22/80
3400/3400 [==============================] - 13s - loss: 0.3677 - acc: 0.8791
Epoch 23/80
3400/3400 [==============================] - 15s - loss: 0.3563 - acc: 0.8926
Epoch 24/80
3400/3400 [==============================] - 13s - loss: 0.3287 - acc: 0.9015
Epoch 25/80
3400/3400 [==============================] - 14s - loss: 0.2990 - acc: 0.9144
Epoch 26/80
3400/3400 [==============================] - 14s - loss: 0.3064 - acc: 0.9088
Epoch 27/80
3400/3400 [==============================] - 13s - loss: 0.3179 - acc: 0.9029
Epoch 28/80
3400/3400 [==============================] - 15s - loss: 0.2981 - acc: 0.9074
Epoch 29/80
3400/3400 [==============================] - 13s - loss: 0.2857 - acc: 0.9106
Epoch 30/80
3400/3400 [==============================] - 13s - loss: 0.2920 - acc: 0.9121
Epoch 31/80
3400/3400 [==============================] - 14s - loss: 0.2718 - acc: 0.9126
Epoch 32/80
3400/3400 [==============================] - 14s - loss: 0.2570 - acc: 0.9256
Epoch 33/80
3400/3400 [==============================] - 13s - loss: 0.2531 - acc: 0.9171
Epoch 34/80
3400/3400 [==============================] - 13s - loss: 0.2167 - acc: 0.9318
Epoch 35/80
3400/3400 [==============================] - 15s - loss: 0.2329 - acc: 0.9291
Epoch 36/80
3400/3400 [==============================] - 14s - loss: 0.2183 - acc: 0.9388
Epoch 37/80
3400/3400 [==============================] - 13s - loss: 0.2000 - acc: 0.9341
Epoch 38/80
3400/3400 [==============================] - 13s - loss: 0.2246 - acc: 0.9324
Epoch 39/80
3400/3400 [==============================] - 14s - loss: 0.2272 - acc: 0.9276
Epoch 40/80
3400/3400 [==============================] - 13s - loss: 0.2154 - acc: 0.9315
Epoch 41/80
3400/3400 [==============================] - 13s - loss: 0.2169 - acc: 0.9335
Epoch 42/80
3400/3400 [==============================] - 15s - loss: 0.2014 - acc: 0.9365
Epoch 43/80
3400/3400 [==============================] - 13s - loss: 0.2012 - acc: 0.9394
Epoch 44/80
3400/3400 [==============================] - 13s - loss: 0.2144 - acc: 0.9374
Epoch 45/80
3400/3400 [==============================] - 13s - loss: 0.2329 - acc: 0.9268
Epoch 46/80
3400/3400 [==============================] - 15s - loss: 0.2356 - acc: 0.9312
Epoch 47/80
3400/3400 [==============================] - 13s - loss: 0.2347 - acc: 0.9288
Epoch 48/80
3400/3400 [==============================] - 14s - loss: 0.2274 - acc: 0.9285
Epoch 49/80
3400/3400 [==============================] - 14s - loss: 0.2205 - acc: 0.9321
Epoch 50/80
3400/3400 [==============================] - 13s - loss: 0.1879 - acc: 0.9465
Epoch 51/80
3400/3400 [==============================] - 13s - loss: 0.1801 - acc: 0.9450
Epoch 52/80
3400/3400 [==============================] - 15s - loss: 0.1803 - acc: 0.9438
Epoch 53/80
3400/3400 [==============================] - 13s - loss: 0.1962 - acc: 0.9388
Epoch 54/80
3400/3400 [==============================] - 13s - loss: 0.2153 - acc: 0.9353
Epoch 55/80
3400/3400 [==============================] - 14s - loss: 0.2040 - acc: 0.9432
Epoch 56/80
3400/3400 [==============================] - 14s - loss: 0.1672 - acc: 0.9494
Epoch 57/80
3400/3400 [==============================] - 13s - loss: 0.1804 - acc: 0.9482
Epoch 58/80
3400/3400 [==============================] - 15s - loss: 0.1794 - acc: 0.9450
Epoch 59/80
3400/3400 [==============================] - 13s - loss: 0.1702 - acc: 0.9482
Epoch 60/80
3400/3400 [==============================] - 13s - loss: 0.1470 - acc: 0.9535
Epoch 61/80
3400/3400 [==============================] - 15s - loss: 0.1640 - acc: 0.9494
Epoch 62/80
3400/3400 [==============================] - 13s - loss: 0.1632 - acc: 0.9509
Epoch 63/80
3400/3400 [==============================] - 13s - loss: 0.1727 - acc: 0.9509
Epoch 64/80
3400/3400 [==============================] - 13s - loss: 0.2006 - acc: 0.9344
Epoch 65/80
3400/3400 [==============================] - 14s - loss: 0.1615 - acc: 0.9550
Epoch 66/80
3400/3400 [==============================] - 13s - loss: 0.1717 - acc: 0.9474
Epoch 67/80
3400/3400 [==============================] - 13s - loss: 0.1869 - acc: 0.9418
Epoch 68/80
3400/3400 [==============================] - 14s - loss: 0.1799 - acc: 0.9453
Epoch 69/80
3400/3400 [==============================] - 13s - loss: 0.1665 - acc: 0.9465
Epoch 70/80
3400/3400 [==============================] - 13s - loss: 0.1582 - acc: 0.9500
Epoch 71/80
3400/3400 [==============================] - 13s - loss: 0.1554 - acc: 0.9550
Epoch 72/80
3400/3400 [==============================] - 13s - loss: 0.1454 - acc: 0.9603
Epoch 73/80
3400/3400 [==============================] - 15s - loss: 0.1566 - acc: 0.9556
Epoch 74/80
3400/3400 [==============================] - 13s - loss: 0.1527 - acc: 0.9538
Epoch 75/80
3400/3400 [==============================] - 13s - loss: 0.1452 - acc: 0.9568
Epoch 76/80
3400/3400 [==============================] - 15s - loss: 0.1323 - acc: 0.9574
Epoch 77/80
3400/3400 [==============================] - 13s - loss: 0.1669 - acc: 0.9512
Epoch 78/80
3400/3400 [==============================] - 13s - loss: 0.1412 - acc: 0.9556
Epoch 79/80
3400/3400 [==============================] - 14s - loss: 0.1514 - acc: 0.9532
Epoch 80/80
3400/3400 [==============================] - 13s - loss: 0.1349 - acc: 0.9556
train time : 1107.608735
39059/39059 [==============================] - 57s
[ True  True  True ...,  True  True  True]
2016-07-12 02:05:46,712 : DEBUG : 正确的个数:38735
正确的个数:38735
准确率为:0.991705
2016-07-12 02:05:46,840 : DEBUG : 准确率为:0.991705
F1为：0.996762|0.991409|0.993914|0.999891|0.999498|0.994003|0.999174|0.986712|0.990426|0.999503|0.992665|0.881533|0.989840|0.971503|1.000000|0.995708|0.991228|1.000000|0.859375|0.993671|0.999136|0.965909|0.969432|0.981481|0.994138|0.979405|0.995633|0.857143|0.730496|0.986203|0.996458|1.000000|0.996647|0.933333
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
2016-07-12 02:05:46,856 : DEBUG : F1为：[ 0.99676208  0.99140866  0.99391404  0.99989101  0.99949774  0.994003
  0.99917396  0.98671159  0.99042597  0.99950306  0.99266504  0.8815331
  0.98984035  0.97150259  1.          0.99570815  0.99122807  1.          0.859375
  0.99367089  0.9991357   0.96590909  0.96943231  0.98148148  0.99413834
  0.97940503  0.99563319  0.85714286  0.73049645  0.98620337  0.99645809
  1.          0.99664655  0.93333333]
precision:[ 0.99948052  0.99414824  1.          1.          0.9996651   1.
  0.99966942  0.99622071  1.          1.          0.99509804  0.78816199
  0.98554913  0.95663265  1.          1.          0.99122807  1.
  0.78014184  0.99367089  1.          0.93406593  0.96521739  0.97247706
  0.99530516  0.95964126  1.          0.75        0.58522727  0.99587203
  1.          1.          0.99865591  0.875     ]
precision为：0.999481|0.994148|1.000000|1.000000|0.999665|1.000000|0.999669|0.996221|1.000000|1.000000|0.995098|0.788162|0.985549|0.956633|1.000000|1.000000|0.991228|1.000000|0.780142|0.993671|1.000000|0.934066|0.965217|0.972477|0.995305|0.959641|1.000000|0.750000|0.585227|0.995872|1.000000|1.000000|0.998656|0.875000
2016-07-12 02:05:46,863 : DEBUG : precision:[ 0.99948052  0.99414824  1.          1.          0.9996651   1.
  0.99966942  0.99622071  1.          1.          0.99509804  0.78816199
  0.98554913  0.95663265  1.          1.          0.99122807  1.
  0.78014184  0.99367089  1.          0.93406593  0.96521739  0.97247706
  0.99530516  0.95964126  1.          0.75        0.58522727  0.99587203
  1.          1.          0.99865591  0.875     ]
recall:[ 0.99405838  0.98868413  0.9879017   0.99978204  0.99933043  0.9880775
  0.998679    0.97738228  0.98103353  0.99900662  0.9902439   1.          0.9941691
  0.98684211  1.          0.99145299  0.99122807  1.          0.95652174
  0.99367089  0.99827288  1.          0.97368421  0.99065421  0.99297424
  1.          0.99130435  1.          0.97169811  0.97672065  0.99294118
  1.          0.99464525  1.        ]
recall为：0.994058|0.988684|0.987902|0.999782|0.999330|0.988077|0.998679|0.977382|0.981034|0.999007|0.990244|1.000000|0.994169|0.986842|1.000000|0.991453|0.991228|1.000000|0.956522|0.993671|0.998273|1.000000|0.973684|0.990654|0.992974|1.000000|0.991304|1.000000|0.971698|0.976721|0.992941|1.000000|0.994645|1.000000
end! Running time:3411s!
2016-07-12 02:05:46,977 : DEBUG : ====================
2016-07-12 02:05:46,977 : DEBUG : end! Running time:3411s!

Process finished with exit code 0
